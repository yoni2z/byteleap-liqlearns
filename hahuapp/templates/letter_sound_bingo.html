{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Letter Sound Bingo</title>
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <script src="{% static 'js/jquery.min.js' %}"></script>
</head>
<body>
    <style>
        .bingo-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
}

.bingo-cell {
    border: 2px solid #000;
    padding: 20px;
    text-align: center;
    cursor: pointer;
    transition: background-color 0.3s;
}

.bingo-cell:hover {
    background-color: #f0f0f0;
}

    </style>
<div class="container mt-5">
    <h1 class="text-center">Letter Sound Bingo</h1>
    <div class="row">
        <div class="col-md-12">
            <h3>{{ question.question_text }}</h3>
            <div class="bingo-grid">
                {% for item in question.options.all %}
                <div class="bingo-cell" data-item-id="{{ item.id }}">
                    {% if item.item_type == 'audio' %}
                        <audio controls>
                            <source src="{{ item.audio.url }}" type="audio/mpeg">
                        </audio>
                    {% elif item.item_type == 'image' %}
                        <img src="{{ item.image.url }}" class="img-fluid" alt="{{ item.title }}">
                    {% elif item.item_type == 'video' %}
                        {% if item.video_file %}
                            <video width="320" height="240" controls>
                                <source src="{{ item.video_file.url }}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        {% elif item.video_url %}
                            <iframe width="320" height="240" src="{{ item.video_url }}" frameborder="0" allowfullscreen></iframe>
                        {% endif %}
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
    $(".bingo-cell").click(function () {
        let itemId = $(this).data("item-id");
        let questionId = "{{ question.id }}";

        $.ajax({
            url: "{% url 'check_answer' %}",
            type: "POST",
            data: {
                'item_id': itemId,
                'question_id': questionId,
                'csrfmiddlewaretoken': '{{ csrf_token }}'
            },
            success: function (response) {
                if (response.correct) {
                    alert("Correct! Good job!");
                } else {
                    alert("Try again.");
                }
            },
            error: function () {
                alert("Something went wrong. Please try again.");
            }
        });
    });
});

</script>
</body>
</html>
