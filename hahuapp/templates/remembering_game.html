<!-- remembering_game.html -->
{% extends 'base.html' %}

{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Remembering Game</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container my-5">
    <h1 class="text-center mb-4">Remembering Game</h1>
    <h2 class="text-center mb-4">After watching the video or image or after you listened the audio try to remember and write down what you saw or heard</h2>
    <h3 class="text-center mb-4">It will dissapear after 5 seconds!!</h3>

    <div id="question-content" class="text-center">
        {% if question.type == "LetterSound" %}
            <p>Listen to this sound:</p>
            <audio controls autoplay src="{{ question.content.sound_file.url }}" class="mb-3"></audio>
        {% elif question.type == "LetterImage" %}
            <p>Look at this image:</p>
            <img src="{{ question.content.image.url }}" alt="Memory Image" class="img-fluid mb-3" id="memory-img">
        {% elif question.type == "LetterVideo" %}
            <p>Watch this video:</p>
            <video controls autoplay src="{{ question.content.video.url }}" class="mb-3"></video>
        {% elif question.type == "WordAudio" %}
            <p>Listen to this word:</p>
            <audio controls autoplay src="{{ question.content.audio_file.url }}" class="mb-3"></audio>
        {% elif question.type == "WordVideo" %}
            <p>Watch this word video:</p>
            <video controls autoplay src="{{ question.content.video_file.url }}" class="mb-3"></video>
        {% endif %}
    </div>

    <div class="input-group my-3">
        <input type="text" id="answer" class="form-control" placeholder="Enter what you remember">
        <button id="submit-answer" class="btn btn-primary">Submit Answer</button>
    </div>

    <button id="next-question" class="btn btn-secondary my-2">Next Question</button>
    
    <p id="response-message" class="mt-3 text-center"></p>
</div>

<script>
    $(document).ready(function() {
        // Hide all media elements (image, audio, video) after 5 seconds
        setTimeout(function() {
            $("#question-content img, #question-content audio, #question-content video").hide(); 
        }, 5000);

        $('#submit-answer').on('click', function() {
            $.ajax({
                url: '',
                type: 'POST',
                data: {
                    'answer': $('#answer').val(),
                    'csrfmiddlewaretoken': '{{ csrf_token }}'
                },
                success: function(response) {
                    $('#response-message').text(response.message).addClass(response.message.includes("Correct") ? 'text-success' : 'text-danger');
                    if (response.new_question) {
                        $('#question-content').load(location.href + " #question-content");
                        $('#answer').val('');  // Clear input field
                    }
                }
            });
        });

        $('#next-question').on('click', function() {
            location.reload();
        });
    });
</script>
</body>
</html>
{% endblock %}
