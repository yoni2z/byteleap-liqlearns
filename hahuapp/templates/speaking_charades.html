{% extends 'base.html' %} {% block content %}
<div class="container text-center mt-5">
  <h2>Word Charades</h2>

  {% if question.video_file %}
  <video width="300" height="300" controls>
    <source src="{{ question.video_file.url }}" type="video/mp4" />
    Your browser does not support the video tag.
  </video>
  {% elif question.image %}
  <img
    src="{{ question.image.url }}"
    alt="Letter Image"
    class="img-fluid"
    style="max-width: 300px; height: auto"
  />
  {% else %}
  <p>No content available.</p>
  {% endif %}

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <input type="hidden" name="content_type" value="{{ content_type_id }}" />
    <input type="hidden" name="object_id" value="{{ object_id }}" />

    <div>
      <label for="recording">Upload your recording:</label>
      <input
        type="file"
        name="recording"
        accept="audio/*"
        required
        id="recordingInput"
      />
    </div>

    <div
      id="audioContainer"
      class="mt-3"
      style="display: none; text-align: center"
    >
      <audio id="audioPreview" controls style="margin: 0 auto"></audio>
    </div>

    <div class="m-3 d-flex justify-content-center align-items-center">
      <button type="submit" class="btn btn-success m-2">Submit Recording</button>
      <button
        type="button"
        id="chooseAnotherButton"
        class="btn btn-warning m-2"
        style="display: none"
      >
        Choose Another
      </button>
    </div>
  </form>

  <div id="feedback" class="mt-3">{{ feedback }}</div>
</div>

<script>
  const recordingInput = document.getElementById("recordingInput");
  const audioPreview = document.getElementById("audioPreview");
  const audioContainer = document.getElementById("audioContainer");
  const chooseAnotherButton = document.getElementById("chooseAnotherButton");

  recordingInput.addEventListener("change", function () {
    const file = recordingInput.files[0];
    if (file) {
      const url = URL.createObjectURL(file);
      audioPreview.src = url;
      audioPreview.style.display = "block"; // Show the audio preview player
      audioContainer.style.display = "block"; // Show the audio container
      chooseAnotherButton.style.display = "block"; // Show the "Choose Another" button
      audioPreview.play(); // Auto-play the audio preview (optional)
    }
  });

  chooseAnotherButton.addEventListener("click", function () {
    recordingInput.value = ""; // Clear the file input
    audioPreview.src = ""; // Clear the audio source
    audioContainer.style.display = "none"; // Hide the audio container
    chooseAnotherButton.style.display = "none"; // Hide the "Choose Another" button
  });
</script>
{% endblock %}
